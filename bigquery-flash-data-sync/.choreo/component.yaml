# +required The configuration file schema version
schemaVersion: 1.2

id: bigquery-flash-data-sync
displayName: BigQuery Flash Data Sync

# +required Type of the component
# Use "Service" for long-running processes or "Job" for batch execution
componentType: Job
description: |
  A Go CLI application that synchronizes MySQL databases to Google Cloud
  BigQuery with automatic schema inference and concurrent processing.

build:
  buildCommand: go build -o bin/datasync cmd/datasync/main.go

runtime:
  command: ./bin/datasync
  args: []

# +optional Network visibility
networkVisibility: Organization

# +optional OpenAPI specification file
schemaFilePath: openapi.yaml

# +optional Environment variable configurations
configMaps:
  - name: app-config
    data:
      - key: LOG_ENV
        value: prod
      - key: LOG_LEVEL
        value: info
      - key: SYNC_TIMEOUT
        value: 10m
      - key: DATE_FORMAT
        value: 2006-01-02T15:04:05Z07:00
      - key: DB_MAX_OPEN_CONNECTIONS
        value: "15"
      - key: DB_MAX_IDLE_CONNECTIONS
        value: "5"

# +optional Secret references (configure actual values in Choreo UI)
secrets:
  - name: gcp-credentials
    data:
      - key: GCP_PROJECT_ID
      - key: BQ_DATASET_ID
  - name: finance-db-credentials
    data:
      - key: FINANCE_DB_NAME
      - key: FINANCE_DB_USER
      - key: FINANCE_DB_PASSWORD
  - name: salesforce-db-credentials
    data:
      - key: SALESFORCE_DB_NAME
      - key: SALESFORCE_DB_USER
      - key: SALESFORCE_DB_PASSWORD
  - name: db-config
    data:
      - key: DB_HOST
      